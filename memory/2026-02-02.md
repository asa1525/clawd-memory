# 2026-02-02

## Obsidian 笔记同步问题解决

### 问题
从 OpenClaw 同步笔记到 Obsidian 时遇到困难：
- 笔记创建到了错误的用户账户
- 内容没有同步
- 文件路径不匹配

### 解决方案

#### 1. Fast Note Sync Service API
- 基础 URL: `http://localhost:9000/api`
- 认证方式: `Authorization: Bearer {token}`
- 需要先登录获取 token

#### 2. 关键 API 端点

| 方法 | 端点 | 说明 |
|------|------|------|
| POST | `/api/user/register` | 注册用户 |
| POST | `/api/user/login` | 登录获取 token |
| POST | `/api/vault` | 创建 Vault |
| POST | `/api/note` | 创建/更新笔记 |
| GET | `/api/note` | 获取笔记 |

#### 3. 登录格式
```json
{
  "credentials": "用户名或邮箱",
  "password": "密码"
}
```

#### 4. 创建笔记格式
```json
{
  "vault": "Obsidian Vault",
  "path": "2026/02/2026-02-02.md",
  "content": "# 笔记内容"
}
```

#### 5. 存储结构
- 数据库: `~/.openclaw/workspace/storage/database/`
  - `db_user_1.sqlite3` - 用户1的笔记
  - `db_user_2.sqlite3` - 用户2的笔记
  - `db_user_vault_1.sqlite3` - 用户1的 Vault 配置
- 文件: `~/.openclaw/workspace/storage/vault/u_1/note/`

#### 6. 关键教训
- 确保笔记创建在正确的用户账户
- 文件系统和数据库需要同步更新
- Obsidian 插件需要手动刷新才能看到新笔记

### 成功操作流程
1. 创建 dnlm@test.com 用户用于 API 操作
2. 为每个用户创建 Obsidian Vault
3. 使用 API 创建笔记（路径格式: `YYYY/MM/YYYY-MM-DD.md`）
4. 更新文件系统和数据库
5. 重启同步服务
6. 在 Obsidian 中手动刷新

### 待办
- 自动化这个流程（脚本化）
- 简化用户认证步骤
